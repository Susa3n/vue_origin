{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observer/Array.js","../src/observer/dep.js","../src/observer/index.js","../src/next-tick.js","../src/observer/scheduler.js","../src/observer/watcher.js","../src/state.js","../src/compiler/parseHtml.js","../src/compiler/generate.js","../src/compiler/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/vdom/create-vdom.js","../src/render.js","../src/index.js"],"sourcesContent":["export function isFunction(value) {\r\n  return typeof value === 'function'\r\n}\r\nexport function isObject(value) {\r\n  return typeof value === 'object' && value != null\r\n}\r\n\r\n\r\n\r\n\r\n\r\n","let oldMethods = Array.prototype\r\nexport let arrayMethods = Object.create(oldMethods) // 旧数组的原型方法\r\nlet methods = [\r\n  'push',\r\n  'shift',\r\n  'unshift',\r\n  'splice',\r\n  'pop',\r\n  'sort',\r\n  'reverse'\r\n]\r\n\r\nmethods.forEach(method => {\r\n  arrayMethods[method] = function (...args) { // args 是参数列表\r\n  // 这里的this指的是谁调的   比如data: {a:[1,2,3]}  vm.a.push(4) 此时[1,2,3]就为当前的this\r\n    oldMethods[method].call(this, ...args) // 执行旧数组上的方法\r\n    let inserted;\r\n    let ob = this.__ob__ // 在对数组外层观测时 将当前实例挂载的this挂载到__ob__属性\r\n    switch (method) { // 判断如果是push  shift splice 方法  对于新增的属性进行数据劫持 args为新增的数据\r\n      case 'push':\r\n      case 'shift':\r\n        inserted = args \r\n        break;\r\n      case 'splice': // splice的第二个参数以后都为新增的数据\r\n        inserted = args.slice(2)\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    if (inserted) ob.observerArray(inserted) // 通过observerArray递归进行数据劫持\r\n    ob.dep.notify() //如果数据发生变化  通过dep通知对应的watcher进行关联\r\n  }\r\n})","let id = 0\r\nexport class Dep {\r\n  constructor() {\r\n    this.id = id++\r\n    this.sub = []\r\n  }\r\n\r\n  append() {\r\n    Dep.target.append(this) // dep添加watcher\r\n  }\r\n  addSub(watcher) { // 反之 watcher添加dep\r\n    this.sub.push(watcher)\r\n  }\r\n\r\n  notify() { \r\n    this.sub.forEach(watcher => watcher.update()) // 将当前dep中收集到的watcher进行更新\r\n  }\r\n\r\n\r\n}\r\nDep.target = null\r\nexport function pushTarget(watcher) {\r\n  Dep.target = watcher\r\n}\r\n\r\nexport function popTarget() {\r\n  Dep.target = null\r\n}","\r\nimport { isObject } from \"../utils\";\r\nimport { arrayMethods } from './Array'\r\nimport { Dep } from './dep'\r\n\r\n// 如果数据是对象 会对对象递归 进行数据劫持\r\n// 如果是数组 会劫持数组的方法 并对数组上不是基本数据类型的数据进行数据劫持\r\n\r\nclass Observer {\r\n  constructor(data) {\r\n    // 给要劫持的数据上添加__ob__属性，指定为当前this（两个作用）\r\n    // 一： observe劫持数据时可以通过是否有__ob__属性来判断是否已经劫持过 劫持过直接return\r\n    // 二：调用数组的方法（push、shift、splice...）对于新增的数据，可以通过this.__ob__.observerArray递归劫持\r\n    // data.__ob__ = this   如果直接放到data的属性上，当walk(data)时会遍历__ob__上的属性，导致递归爆栈\r\n    // 解决方法： 通过 Object.defineProperty 设置不可枚举\r\n    this.dep = new Dep()\r\n    Object.defineProperty(data, '__ob__', {\r\n      value: this,\r\n      enumerable: false // 不可枚举\r\n    })\r\n    if (Array.isArray(data)) { // 处理数组格式\r\n      // 对数组劫持的逻辑\r\n      data.__proto__ = arrayMethods  // 对数组原来的方法进行重改\r\n      this.observerArray(data) // 对数据中的数据 进行递归劫持\r\n    } else { //处理对象格式\r\n      this.walk(data) // 对对象中所有的属性进行数据劫持\r\n    }\r\n  }\r\n  observerArray(data) {\r\n    for (let i = 0; i < data.length; i++) { // 遍历数组中的每一项 劫持数据\r\n      observe(data[i])\r\n    }\r\n  }\r\n\r\n  walk(data) {\r\n    Object.keys(data).forEach(key => { // 遍历data拿到所有的key\r\n      defineReactive(data, key, data[key])\r\n    })\r\n  }\r\n\r\n\r\n}\r\n\r\nfunction observeArray(value) {\r\n  if(Array.isArray(value)){ // 是数组类型 进行遍历\r\n    value.forEach(currentValue => {\r\n      let ob = observe(currentValue) // 拿去下一层的dep实例 如果有进行下一层关联\r\n      if(ob){\r\n        ob.dep.append()\r\n      } \r\n      observeArray(currentValue) // 递归关联\r\n    })\r\n  }\r\n}\r\n\r\nfunction defineReactive(data, key, value) { // 将数据定义为响应式\r\n  let dep = new Dep() // 数据劫持时给数据绑定对应的dep\r\n  let childOb = observe(value) // value可能还是对象  递归进行劫持,value是数组或value时，为了将value的dep的和视图watcher进行关联，此时childOb是数组或对象的dep实例\r\n  Object.defineProperty(data, key, {\r\n    get() { // 在watcher中读取对应数据 会判断Dep.target是否是watcher\r\n      if(Dep.target) { // 如果是\r\n        dep.append() // 将当前dep（也就是当前数据）进行关联\r\n        if(childOb) { // 如果有值 数组去关联视图watcher\r\n          childOb.dep.append()\r\n          observeArray(value) // 递归将下一层的数据进行关联watcher  [[[1,2,3]]]\r\n        }\r\n      }\r\n      return value\r\n    },\r\n    set(newValue) {\r\n      // 如果set的newValue是一个对象 也要对对象进行劫持\r\n      if(newValue !=  value) {\r\n        observe(newValue)\r\n        value = newValue\r\n        dep.notify() // 通知对应观察者执行操作\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n\r\nexport function observe(data) { // 观测数据\r\n  // 判断用户返回的data是否是对象 如果不是直接返回\r\n  if (!isObject(data)) {\r\n    return\r\n  }\r\n\r\n  if (data.__ob__) {\r\n    return data.__ob__\r\n  }\r\n\r\n  // data最外层默认是对象\r\n  return new Observer(data) // 返回一个实例\r\n}\r\n\r\n\r\n/**\r\n * data(){\r\n *  return {\r\n *      person: [{name:'susa3n'}]\r\n *    }\r\n * }\r\n * 完整的初始化流程：\r\n *  observe最开始观测data时，最外层是对象形式，遍历所有的key，进行数据劫持，\r\n * 将当前实例挂载到数组上__ob__ = this，当发现第二层值为数组时，调用observerArray方法，传入当前值，遍历数组进行递归劫持。\r\n * vm.person.push({name:'lisi'}) 执行旧数组原型上的方法 对新增的数据 通过__ob__.observerArray(args)\r\n *\r\n */","\r\nlet callbacks = []\r\nlet waiting = false \r\n\r\nfunction flushCallbacks() {\r\n  callbacks.forEach(cb => cb())\r\n  waiting = false\r\n  callbacks = []\r\n}\r\n\r\nfunction timerFn() {\r\n  let timer = null\r\n  if(Promise) { // \r\n    timer = () => {\r\n      Promise.resolve().then(() => {\r\n        flushCallbacks()\r\n      })\r\n    }\r\n  }else if(MutationObserver) {\r\n    let textNode = document.createTextNode(1)\r\n    let observe = new MutationObserver(flushCallbacks)\r\n    observe.observe(textNode,{\r\n      characterData: true\r\n    })\r\n    timer = () => {\r\n      textNode.textContent = 3\r\n    }\r\n  }else {\r\n    timer = setTimeout(flushCallbacks);\r\n  }\r\n  timer()\r\n}\r\n\r\nexport function nextTick(cb) { // 接收一个回调函数\r\n  callbacks.push(cb) // push到callbacks中\r\n  if(!waiting){ // 异步执行一次 \r\n    timerFn()\r\n    waiting = true\r\n  }\r\n}\r\n","import { nextTick } from '../next-tick'\r\nlet queue = []\r\nlet has = {}\r\nlet pending = false\r\n\r\n\r\nfunction flushSchedulerQueue() {\r\n  queue.forEach(watcher => { // 从queue遍历所有的watcher 进行更新\r\n    watcher.run()\r\n    queue = []; // 让下一次可以继续使用 清空数据\r\n    has = {};\r\n    pending = false\r\n  })\r\n}\r\n\r\nexport function queueWatcher(watcher) {\r\n  let id = watcher.id // 拿取watcher的id\r\n  if (has[id] == null) { // 判断当前watcher是否在has对象中\r\n    queue.push(watcher) // 将当前watcher push 到对列中\r\n    has[id] = true // has中保存watcher的id置为true\r\n    if (!pending) { // 默认false 之后置为true 只让更新操作改为异步的，执行nexttick\r\n      // setTimeout(flushSchedulerQueue,0);\r\n      nextTick(flushSchedulerQueue)  // 执行异步更新视图的方法\r\n      pending = true\r\n    }\r\n\r\n  }\r\n}","import { pushTarget, popTarget } from \"./dep\"\r\nimport { queueWatcher } from './scheduler'\r\nlet id = 0\r\nexport class Watcher {\r\n  /**\r\n   *  Watcher是一个类，生成一个观察者\r\n   * @param {*} vm 被观测的对象或者数据\r\n   * @param {*} exprOrFn  被观测的对象发生变化执行对应操作（渲染watcher是函数，在computed或者watch中是表达式）\r\n   * @param {*} cb 执行完对应操作后的回调函数\r\n   * @param {*} options 配置对象\r\n   */\r\n  constructor(vm, exprOrFn, cb, options) {\r\n    // 将传入的参数保存到实例本身\r\n    this.vm = vm\r\n    this.cb = cb // 保存回调函数\r\n    this.options = options\r\n    this.user = options.user // 用户watch\r\n    if(typeof exprOrFn == 'string') { // 如果是用户watch exprOrFn是一个表达式 'name' 'person.nam'\r\n      this.getter = function() {  // getter为一个函数，通过表达式的取值 将watcher 和 表达式的dep进行关联\r\n        let obj = vm \r\n        exprOrFn.split('.').forEach(i => {\r\n          obj = obj[i]\r\n        })\r\n        return obj\r\n      }\r\n    }else {\r\n      this.getter = exprOrFn // 挂载到实例的getter属性上，当被观测的数据发生变化 执行this.get\r\n    }\r\n    this.id = id++\r\n    this.deps = []\r\n    this.depIds = new Set()\r\n    this.value = this.get() // 默认第一次执行 拿到watcher的值 保存到实例上，以便用户watcher发生变化执行callback传入对应新值和旧值\r\n  }\r\n\r\n  get() { // 利用JS的单线程\r\n    pushTarget(this) // 开始：将watcher（页面）和dep（数据） 进行关联起来\r\n    let value = this.getter() // 读取对应数据 \r\n    popTarget()\r\n    return value\r\n  }\r\n\r\n\r\n\r\n  append(dep) { // 接收dep\r\n    if (!this.depIds.has(dep.id)) {  // 判断当前watcher中depIds中是否有当前dep\r\n      this.depIds.add(dep.id) // 将接收的dep的id set到当前watcher实例depIds\r\n      this.deps.push(dep) // 将dep保存到watcher的deps中\r\n      dep.addSub(this) // 反之将watcher关联到dep中\r\n    }\r\n  }\r\n\r\n  update() { // 当前观察者执行对应操作\r\n    // this.get()\r\n    // 如果数据改变通知对应watcher进行update，当多次更改数据时，会导致多次渲染页面，可以将渲染界面改为异步\r\n    // 通过queueWatcher收集watcher，之后进行异步更新\r\n    queueWatcher(this) \r\n  }\r\n\r\n  run() {\r\n    let oldValue = this.value // 当监听的值发生变化保存旧值在当前作用域\r\n    let newValue = this.value = this.get() // 保存新值到实例上 用于下次更新\r\n    if(this.user) {\r\n      this.cb.call(this.vm,newValue,oldValue) // 如果是用户watcher 执行回调函数 传入参数\r\n    }\r\n  }\r\n\r\n\r\n}\r\n\r\n// watcher 和 dep\r\n// 我们将更新界面的功能封装了一个渲染watcher\r\n// 渲染页面前，会将watcher放到Dep的类上  Dep.target = watcher\r\n// 在vue中页面渲染时使用属性，需要进行依赖收集，收集对象的渲染watcher\r\n  // 取值时给每个属性都加了一个dep实例，用于存储渲染watcher（同一个watcher可能存有多个dep）\r\n  // 每个属性可能对应多个视图（多个视图就对应多个watcher） 一个属性对应多个watcher\r\n// dep.depend() => 通知dep存放watcher  Dep.target.addDep () => 通知watcher存放dep","import { isFunction } from \"./utils\" // 引入工具函数判断当前值是否是函数类型\r\nimport { observe } from \"./observer/index\"\r\nimport { Watcher } from \"./observer/watcher\"\r\nexport function initState(vm) {\r\n  const opts = vm.$options \r\n  if(opts.data) { // 如果选项中有data\r\n    initData(vm) // 对data进行初始化\r\n  }\r\n  // if(opts.computed){\r\n  //   initComputed()\r\n  // }\r\n  if(opts.watch){\r\n    initWatch(vm,opts.watch)\r\n  }\r\n}\r\n\r\nfunction initData(vm) { // 初始化data方法\r\n  let data = vm.$options.data // vm中$符号开头的属性不会被代理\r\n  // vue2中会将所有层次的数据进行数据劫持 通过Object.defineProperty\r\n\r\n  // call的原因 data中所有数据的this都指向当前实例 vm\r\n  data = vm._data = isFunction(data) ? data.call(vm) : data \r\n  for (const key in data) { // 通过proxy代理将data上的数据定义vm上，当读取属性时还是走的observe\r\n    proxy(vm,'_data',key)\r\n  }\r\n  // 观测数据 将数据变为响应式的\r\n  observe(data)\r\n}\r\n\r\nfunction initWatch(vm,watch) { // 初始化watch方法\r\n  for (const key in watch) { // 遍历watch\r\n    let handler = watch[key]\r\n    if(Array.isArray(handler)) { // 判断value的类型，如果是数组类型 需要创建多个用户watch\r\n      handler.forEach(handlerFn => {\r\n        createWatch(vm,key,handlerFn)\r\n      })\r\n    }else {\r\n      if(typeof handler === 'object') { // 如果是对象类型 取出handler函数，收集配置对象，创建用户watch\r\n        createWatch(vm,key,handler.handler,handler)\r\n      }else {\r\n        createWatch(vm,key,handler) // 如果是函数 直接创建用户watchr\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction createWatch(vm,key,handler,options = {}) {\r\n  return vm.$watch(key,handler,options) // 通过$watch进行中转\r\n}\r\n\r\n\r\n// 数据代理\r\nfunction proxy(vm,source,key) {\r\n  Object.defineProperty(vm,key,{\r\n    get() {\r\n      return vm[source][key]\r\n    },\r\n    set(newValue) {\r\n      vm[source][key] = newValue\r\n    }\r\n  })\r\n}\r\n\r\nexport function stateMixin(Vue) {\r\n  Vue.prototype.$watch = function (key,handler,options) { // 在Vue的原型上混入$watch的方法 创建用户监听\r\n    options.user = true // 配置对象 用户watch为true\r\n    let userWatcher = new Watcher(this,key,handler,options) // 生产watch实例传入 当前vm，表达式，callback，配置对象\r\n    if(options.immediate) {\r\n      handler(userWatcher.value)\r\n    }\r\n  }\r\n}","\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // abc-aaa\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // <aaa:asdads>\r\n//  /^<((?:[a-zA-Z_][\\-\\.0-9_a-zA-Z]*\\:)?[a-zA-Z_][\\-\\.0-9_a-zA-Z]*)/\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名 \r\n// /^<\\/((?:[a-zA-Z_][\\-\\.0-9_a-zA-Z]*\\:)?[a-zA-Z_][\\-\\.0-9_a-zA-Z]*)[^>]*>/\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >  <div>\r\n\r\n\r\nlet root = null;\r\nlet currParent;\r\nlet stack = [];\r\nconst ELEMENT_TYPE = 1 // 标签节点  \r\nconst TEXT_TYPE = 3 // 文本节点\r\n\r\n// 将html字符串通过正则的形式解析出ast\r\nexport function parserHtml(html) { // <div id=\"app\"></app>\r\n  while (html) { // 循环解析\r\n    let textEnd = html.indexOf('<') // 查看是否以<开头\r\n    if (textEnd == 0) {\r\n      const startTagMatch = parseStartTag() // 解析开始标签\r\n      if (startTagMatch) {\r\n        start(startTagMatch.tagName, startTagMatch.attrs)\r\n        continue\r\n      }\r\n\r\n      const endTagMatch = parseEndTag(html)\r\n      if (endTagMatch) {\r\n        end(endTagMatch[1])\r\n        continue\r\n      }\r\n\r\n    }\r\n    let text\r\n    if (textEnd > 0) {\r\n      text = html.substring(0, textEnd)\r\n    }\r\n    if (text) {\r\n      chars(text)\r\n      advance(text.length)\r\n    }\r\n\r\n  }\r\n\r\n  function parseStartTag() {\r\n    let start = html.match(startTagOpen) // 将模板字符串匹配开始标签\r\n    if (start) { // 匹配到 创建match对象保存当前 开始标签名 默认属性为空\r\n      const match = {\r\n        tagName: start[1],\r\n        attrs: []\r\n      }\r\n      advance(start[0].length) // 截取已经匹配到的开始标签\r\n      let end, attr\r\n      // 循环匹配 不结束标签 和 属性 当两者同时成立时 拿去匹配到的属性名和属性值 push到 match中 \r\n      while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n        match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\r\n        advance(attr[0].length) // 截取已经匹配到的属性\r\n      }\r\n      if (end) { // 当匹配到结束标签时\r\n        advance(end[0].length)\r\n        return match\r\n      }\r\n    }\r\n  }\r\n\r\n  function parseEndTag() {\r\n    let endTagMatch = html.match(endTag) // 将模板字符串匹配开始标签\r\n    advance(endTagMatch[0].length)\r\n    return endTagMatch\r\n  }\r\n\r\n  function advance(len) {\r\n    html = html.substring(len)\r\n  }\r\n\r\n  return root\r\n}\r\n\r\n\r\nfunction createElement(tagName, attrs) {\r\n  return {\r\n    type: ELEMENT_TYPE,\r\n    tag: tagName,\r\n    children: [],\r\n    attrs,\r\n    parent: null\r\n  }\r\n}\r\n\r\nfunction start(tagName, tagAttrs) {\r\n  let element = createElement(tagName, tagAttrs)\r\n  if (!root) {\r\n    root = element\r\n  }\r\n  stack.push(element)\r\n  currParent = element\r\n}\r\nfunction end(tagName) {\r\n  let currentElement = stack.pop()\r\n  let parentElement = stack[stack.length - 1]\r\n  if (tagName == currentElement.tag) {\r\n    if (parentElement) {\r\n      parentElement.children.push(currentElement)\r\n      currentElement.parent = parentElement\r\n    }\r\n  }\r\n}\r\nfunction chars(text) {\r\n  text = text.replace(/\\s/g, '')\r\n  if (text) {\r\n    currParent.children.push({\r\n      type: TEXT_TYPE,\r\n      text\r\n    })\r\n  }\r\n}\r\n\r\n","\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g  // 匹配插值语法\r\n\r\nfunction geneProps(attrs) {\r\n  let props = `` \r\n  attrs.forEach(attr => { // 遍历当前节点的属性list  {id:'app',class:'classA',style: {font-size: '14px',color:'red'}}\r\n    if(attr.name === 'style') { // 如果当前属性item的name为style {font-size: '14px';color:'red'}\r\n      let obj = {} // 定义空对象\r\n      attr.value.split(';').forEach(styleItem => {   // 拿到当前value进行split  [font-size: '14px',color:'red']\r\n        let [key,value] = styleItem.split(':') // [key: 'font-size',value: '14px']  [key: 'color',value: 'red']\r\n        obj[key] = `${value}` // obj = {font-size: '14px',color: 'red'}\r\n      })\r\n      attr.value = obj // attr.style = {font-size: '14px',color: 'red'}\r\n    }\r\n    props += `${attr.name}:${JSON.stringify(attr.value)},` // 如果name不是style,直接拼:props = id:'app',class:'classA',style:{font-size: '14px';color:'red'}\r\n  })\r\n  return `{${props.slice(0,-1)}}` // return {id:'app',class:'classA',style:{font-size: '14px';color:'red'}}\r\n}\r\n\r\nfunction gen(node) {\r\n  if(node.type == 1){ // 如果当前节点为为标签节点  递归调用generate方法\r\n    return generate(node)\r\n  }else { // 如果是文本节点\r\n    let text = node.text // 获取文本内容\r\n    let tokens = []; // 定义空数组 方便依次递加\r\n    let match;\r\n    let lastIndex = defaultTagRE.lastIndex = 0 // defaultTagRE插值语法{{}} 匹配每次用exec匹配时候默认最后一次匹配项为0\r\n    while(match = defaultTagRE.exec(text)){ // while循环去匹配当前text = \"hello  {{name}}  word\"\r\n      let index = match.index //开始索引 第一次匹配到的index  hello  的长度\r\n      if(index > lastIndex) { // 将hello  push到tokens中\r\n        tokens.push(JSON.stringify(text.slice(lastIndex,index))) // 截取普通字符串\r\n      }\r\n      tokens.push(`_s(${match[1].trim()})`) // 截取插值语法字符串push到tokens中\r\n      lastIndex = index + match[0].length // 将当前lastIndex = hello  {{name}}的长度 循环匹配直至最后一次 \r\n    }\r\n    if(lastIndex<text.length) { // 将最后的  word push到tokens中\r\n      tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n    }\r\n    return `_v(${tokens.join('+')})` // 转为字符串return\r\n  }\r\n}\r\n\r\nfunction geneChildren(root) { \r\n  let children = root.children // 拿到当前children 判断children是否大于0 继续转化子节点 \r\n  if(children && children.length > 0) {\r\n    return children.map(c => gen(c)).join(',') \r\n  }else{\r\n    return false\r\n  }\r\n}\r\n\r\nexport function generate(root) { // 传入ast语法树\r\nlet children = geneChildren(root) // 转化当前传入的root.children\r\n  //  geneProps(root.attrs) 转化 当前节点的属性\r\n  let code = `_c('${root.tag}',${root.attrs.length > 0 ? geneProps(root.attrs) : undefined}${children ? `,${children}` : ''})`\r\n  return code\r\n}","\r\nimport { parserHtml } from \"./parseHtml\"\r\nimport { generate } from \"./generate\";\r\nexport function compileToFunction(template) {\r\n  let root = parserHtml(template) // 编译模板字符串 转为 ast语法\r\n  let code = generate(root)\r\n  let render = new Function(`with(this){ return ${code}}`)\r\n  // console.log(render.call(vm));\r\n\r\n  return render\r\n}\r\n// vue2 模板编译的顺序\r\n// template模板 通过正则while匹配 匹配成ast语法（组合成树）\r\n// ast => 递归遍历每个节点  编译成code字符串 _c('div',{id: 'app'},_c(span,undefined,_v('hello'+ _s(name) + 'world')))\r\n// 生成render函数（new Function + with）\r\n// return  render函数 通过.call调用 指定with参数this \r\n\r\n\r\n\r\n// let obj = {name:'sau3n'}\r\n// with(obj) {\r\n//   console.log(name);\r\n// }","\r\nexport function patch(oldElm, vnode) {\r\n  const isRealDom = oldElm.nodeType\r\n  if (isRealDom) {\r\n    let el =  createElm(vnode) // 根据虚拟节点创建真实节点\r\n    let parentElm = oldElm.parentNode // 拿去旧节点的父节点 body\r\n    parentElm.insertBefore(el,oldElm.nextSibling) // 在旧节点的下一个节点钱插入编译好的真实节点\r\n    parentElm.removeChild(oldElm);  // 移除旧的节点 进行模板替换\r\n    return el  // 将渲染好的真实节点返回\r\n  }\r\n}\r\n\r\nfunction createElm(vnode) {\r\n  const { tagName, data, key, children, text } = vnode\r\n  if (tagName) { // 如果是元素节点\r\n    vnode.el = document.createElement(tagName) // 创建元素节点\r\n    updateProps(vnode) // 更新当前节点的属性\r\n    if (children && children.length > 0) { // 判断当前节点是否有子节点\r\n      children.forEach(child => { // 遍历子节点\r\n       return vnode.el.appendChild(createElm(child)) //将子节点添加到父节点上\r\n      })\r\n    }\r\n  } else { // 如果是文本节点\r\n    return document.createTextNode(text) // 返回文本节点\r\n  }\r\n  return vnode.el // 返回当前编译好的当前元素节点 用于添加子节点 最后将编译好的根节点返回\r\n}\r\n\r\nfunction updateProps(vnode) { // 更新当前节点的属性\r\n  const el = vnode.el // 拿去当前真实节点\r\n  const attrs = vnode.data // 拿去当前节点的属性\r\n  for (const key in attrs) { // 遍历属性\r\n    if (Object.hasOwnProperty.call(attrs, key)) {\r\n      if (key === 'style') { // 如果当前属性key为style\r\n        // const attr = attrs[key]\r\n        // let str = ``\r\n        // Object.entries(attr).forEach(item => {\r\n        //   let [name, value] = item\r\n        //   str += `${name}:${value}; `\r\n        // })\r\n        // el.setAttribute('style', `${str.slice(0, str.length - 1)}`)\r\n        for (const key in attrs.style) { // 遍历style对象\r\n          el.style[key] = attrs.style[key] // 给当前真实节点添加样式\r\n        } \r\n      } else if (key === 'class') { // 如果当前key是class 给当前真实节点添加class\r\n        el.className = attrs.class\r\n      } else {\r\n        el.setAttribute(key, attrs[key]) // 设置其他属性比如 a:1 <div a=\"1\">\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// 首先 判断 旧的虚拟节点是否为元素节点 nodeType\r\n// 如果是元素节点代表是真实的dom 需要进行渲染操作\r\n// 递归遍历虚拟节点 创建真实节点 在这一过程中将虚拟节点的data属性 挂载到生成真实dom节点的属性上","\r\nimport { Watcher } from \"./observer/watcher\";\r\nimport { patch } from \"./vdom/patch\";\r\nimport { nextTick } from './next-tick'\r\nexport function lifecycleMixin(Vue) {\r\n  Vue.prototype._update = function (vnode) { // 混入_update更新界面的方法 接收参数（执行render函数后生成的对象）\r\n    let vm = this\r\n    vm.$el = patch(vm.$el, vnode); // 需要用虚拟节点创建出真实节点 替换掉 真实的$el\r\n    // 我要通过虚拟节点 渲染出真实的dom\r\n\r\n  },\r\n\r\n    Vue.prototype.$nextTick = nextTick\r\n}\r\n\r\n// 后续可能还会调用此函数 数据刷新更新界面\r\nexport function mountComponent(vm, el) {\r\n  const options = vm.$options\r\n  vm.$el = el\r\n  let updateComponent = () => {\r\n    vm._update(vm._render())\r\n  }\r\n\r\n  // updateComponent()\r\n  new Watcher(vm, updateComponent, () => {\r\n    console.log('更新界面');\r\n  }, true)\r\n\r\n}\r\n\r\n//  在数据劫持的过程中所有的数据绑定对应dep \r\n// 需要将数据和页面进行关联起来，数据发生变化自动进行更新视图，调用渲染函数 mountComponent\r\n// 创建观察者模式，属性是“被观察者” 渲染函数是“观察者”，当被观察者发生改变，观察者执行对应操作\r\n// Watcher 创建一个类的实例  是观察者\r\n  // 参数1：传入被观测的数据，\r\n  // 参数2：被观察者发生变化后执行观察者的操作\r\n  // 参数3：用户自定义的回调函数，执行完观察者的操作后悔调用回调函数\r\n  // 参数4：配置参数，如果是渲染watcher 配置参数默认为true\r\n","import { initState } from \"./state\"\r\nimport { compileToFunction } from \"./compiler/index\"\r\nimport { mountComponent } from \"./lifecycle\"\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function(options) {\r\n    const vm = this // 缓存this 保存到当前作用域\r\n    vm.$options = options  // 将选项保存到实例的$options\r\n\r\n    // 对数据进行初始化 比如 data  computed watch ...\r\n    initState(vm)\r\n\r\n    if(vm.$options.el){\r\n      vm.$mount(vm.$options.el) // 挂载界面，如果当前配置项有el属性，传入当前el\r\n    }\r\n  }\r\n  Vue.prototype.$mount = function(el) {\r\n    const vm = this\r\n    let options = vm.$options\r\n    el = document.querySelector(el)\r\n    if(!options.render) { // render配置项高于el\r\n      let template = options.template\r\n      if(!template && el) { // 判断配置项是否有template属性  如果没有就拿el的outerHTML\r\n        template = el.outerHTML // 模板字符串  之后通过正则进行匹配 将模板字符串转为render渲染函数\r\n        let render = compileToFunction(template) // 拿到render函数\r\n        options.render = render // 挂载到配置项中，以后数据发生变化 可以通过配置项直接执行渲染函数\r\n      }\r\n    }\r\n    mountComponent(vm,el) // 拿到render函数后 渲染界面\r\n  }\r\n\r\n}\r\n","export function createElementNode(tagName,data = {},...children) { // 编译节点 最终返回一个对象\r\n  let key = data.key\r\n  if(key) {\r\n    delete data.key\r\n  }\r\n  return vnode(tagName,data,key,children,undefined)\r\n}\r\n\r\nexport function createTextNode(text) { // 翻译文本内容\r\n  return vnode(undefined,undefined,undefined,undefined,text)\r\n}\r\n\r\nfunction vnode(tagName, data, key, children, text) { // 节点名称  节点属性 节点key 子节点  文本内容\r\n  return {\r\n    tagName, data, key, children, text\r\n  }\r\n}","import { createTextNode, createElementNode } from \"./vdom/create-vdom\"\r\n\r\n//  Vue原型混入 _c _v  _s 方法执行render函数时会用到。\r\n\r\nexport function renderMixin(Vue) {\r\n  Vue.prototype._c = function () { // 编译元素节点\r\n    return createElementNode(...arguments)\r\n  }\r\n\r\n  Vue.prototype._v = function (text) {  // 编译文本节点\r\n    return createTextNode(text)\r\n  }\r\n\r\n  Vue.prototype._s = function (val) { // 编译插值语法 \r\n    return val === null ? '' : (typeof val === 'object' ? JSON.stringify(val) : val); // 如果取到当前值是对象 需要stringify转化\r\n  }\r\n\r\n  Vue.prototype._render = function () {\r\n    let render = this.$options.render // 拿到配置对象中的render方法 \r\n    return render.call(this) // 调用 render方法 this指向当前实例  返回执行render函数后 产生的一个对象\r\n  }\r\n}\r\n\r\n//  _c('div',{id:\"app\",class:\"warp\",style:{\"font-size\":\" 16px\",\"color\":\"red\"}},_c('span',undefined,_v(\"hello\"+_s(name)+\"word\")),_c('ul',undefined,_c('li',undefined,_v(_s(person.name))),_c('li',undefined,_v(_s(person.age)))))}","import {initMixin} from './init'\r\nimport { lifecycleMixin } from './lifecycle'\r\nimport {renderMixin} from './render'\r\nimport {stateMixin} from './state'\r\nfunction Vue (options) { \r\n  // options 用户传入的选项\r\n  this._init(options) // 根据选项进行初始化\r\n}\r\n\r\ninitMixin(Vue) // 给Vue的原型添加_init的方法，传入Vue\r\nrenderMixin(Vue) // 给Vue原型添加_c _v _s _render 方法\r\nstateMixin(Vue)\r\nlifecycleMixin(Vue)\r\nexport default Vue"],"names":["isFunction","value","isObject","oldMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","call","inserted","ob","__ob__","slice","observerArray","dep","notify","id","Dep","sub","target","append","watcher","push","update","pushTarget","popTarget","Observer","data","defineProperty","enumerable","isArray","__proto__","walk","i","length","observe","keys","key","defineReactive","observeArray","currentValue","childOb","get","set","newValue","callbacks","waiting","flushCallbacks","cb","timerFn","timer","Promise","resolve","then","MutationObserver","textNode","document","createTextNode","characterData","textContent","setTimeout","nextTick","queue","has","pending","flushSchedulerQueue","run","queueWatcher","Watcher","vm","exprOrFn","options","user","getter","obj","split","deps","depIds","Set","add","addSub","oldValue","initState","opts","$options","initData","watch","initWatch","_data","proxy","handler","handlerFn","createWatch","$watch","source","stateMixin","Vue","userWatcher","immediate","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","root","currParent","stack","ELEMENT_TYPE","TEXT_TYPE","parserHtml","html","textEnd","indexOf","startTagMatch","parseStartTag","start","tagName","attrs","endTagMatch","parseEndTag","end","text","substring","chars","advance","match","attr","name","len","createElement","type","tag","children","parent","tagAttrs","element","currentElement","pop","parentElement","replace","defaultTagRE","geneProps","props","styleItem","JSON","stringify","gen","node","generate","tokens","lastIndex","exec","index","trim","join","geneChildren","map","c","code","undefined","compileToFunction","template","render","Function","patch","oldElm","vnode","isRealDom","nodeType","el","createElm","parentElm","parentNode","insertBefore","nextSibling","removeChild","updateProps","child","appendChild","hasOwnProperty","style","className","setAttribute","lifecycleMixin","_update","$el","$nextTick","mountComponent","updateComponent","_render","console","log","initMixin","_init","$mount","querySelector","outerHTML","createElementNode","renderMixin","_c","arguments","_v","_s","val"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAO,SAASA,UAAT,CAAoBC,KAApB,EAA2B;EAChC,EAAO,OAAA,OAAOA,KAAP,KAAiB,UAAxB,CAAA;EACD,CAAA;EACM,SAASC,QAAT,CAAkBD,KAAlB,EAAyB;EAC9B,EAAA,OAAO,QAAOA,KAAP,CAAA,KAAiB,QAAjB,IAA6BA,KAAK,IAAI,IAA7C,CAAA;EACD;;ECLD,IAAIE,UAAU,GAAGC,KAAK,CAACC,SAAvB,CAAA;EACO,IAAIC,YAAY,GAAGC,MAAM,CAACC,MAAP,CAAcL,UAAd,CAAnB;;EACP,IAAIM,OAAO,GAAG,CACZ,MADY,EAEZ,OAFY,EAGZ,SAHY,EAIZ,QAJY,EAKZ,KALY,EAMZ,MANY,EAOZ,SAPY,CAAd,CAAA;EAUAA,OAAO,CAACC,OAAR,CAAgB,UAAAC,MAAM,EAAI;EACxBL,EAAAA,YAAY,CAACK,MAAD,CAAZ,GAAuB,YAAmB;EAAA,IAAA,IAAA,kBAAA,CAAA;;EAAA,IAAA,KAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAANC,IAAM,GAAA,IAAA,KAAA,CAAA,IAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,IAAA,GAAA,IAAA,EAAA,IAAA,EAAA,EAAA;EAANA,MAAAA,IAAM,CAAA,IAAA,CAAA,GAAA,SAAA,CAAA,IAAA,CAAA,CAAA;EAAA,KAAA;;EAAE;EAC5C;EACE,IAAAT,CAAAA,kBAAAA,GAAAA,UAAU,CAACQ,MAAD,CAAV,EAAmBE,IAAnB,CAAA,KAAA,CAAA,kBAAA,EAAA,CAAwB,IAAxB,CAAA,CAAA,MAAA,CAAiCD,IAAjC,CAAA,CAAA,CAFwC;;;EAGxC,IAAA,IAAIE,QAAJ,CAAA;EACA,IAAA,IAAIC,EAAE,GAAG,IAAKC,CAAAA,MAAd,CAJwC;;EAKxC,IAAA,QAAQL,MAAR;EAAkB;EAChB,MAAA,KAAK,MAAL,CAAA;EACA,MAAA,KAAK,OAAL;EACEG,QAAAA,QAAQ,GAAGF,IAAX,CAAA;EACA,QAAA,MAAA;;EACF,MAAA,KAAK,QAAL;EAAe;EACbE,QAAAA,QAAQ,GAAGF,IAAI,CAACK,KAAL,CAAW,CAAX,CAAX,CAAA;EACA,QAAA,MAAA;EAPJ,KAAA;;EAWA,IAAIH,IAAAA,QAAJ,EAAcC,EAAE,CAACG,aAAH,CAAiBJ,QAAjB,EAhB0B;;EAiBxCC,IAAAA,EAAE,CAACI,GAAH,CAAOC,MAAP,GAjBwC;EAkBzC,GAlBD,CAAA;EAmBD,CApBD,CAAA;;ECZA,IAAIC,IAAE,GAAG,CAAT,CAAA;EACA,IAAaC,GAAb,gBAAA,YAAA;EACE,EAAc,SAAA,GAAA,GAAA;EAAA,IAAA,eAAA,CAAA,IAAA,EAAA,GAAA,CAAA,CAAA;;EACZ,IAAKD,IAAAA,CAAAA,EAAL,GAAUA,IAAE,EAAZ,CAAA;EACA,IAAKE,IAAAA,CAAAA,GAAL,GAAW,EAAX,CAAA;EACD,GAAA;;EAJH,EAAA,YAAA,CAAA,GAAA,EAAA,CAAA;EAAA,IAAA,GAAA,EAAA,QAAA;EAAA,IAAA,KAAA,EAME,SAAS,MAAA,GAAA;EACPD,MAAAA,GAAG,CAACE,MAAJ,CAAWC,MAAX,CAAkB,IAAlB,EADO;EAER,KAAA;EARH,GAAA,EAAA;EAAA,IAAA,GAAA,EAAA,QAAA;EAAA,IASE,KAAA,EAAA,SAAA,MAAA,CAAOC,OAAP,EAAgB;EAAE;EAChB,MAAA,IAAA,CAAKH,GAAL,CAASI,IAAT,CAAcD,OAAd,CAAA,CAAA;EACD,KAAA;EAXH,GAAA,EAAA;EAAA,IAAA,GAAA,EAAA,QAAA;EAAA,IAAA,KAAA,EAaE,SAAS,MAAA,GAAA;EACP,MAAA,IAAA,CAAKH,GAAL,CAASb,OAAT,CAAiB,UAAAgB,OAAO,EAAA;EAAA,QAAIA,OAAAA,OAAO,CAACE,MAAR,EAAJ,CAAA;EAAA,OAAxB,EADO;EAER,KAAA;EAfH,GAAA,CAAA,CAAA,CAAA;;EAAA,EAAA,OAAA,GAAA,CAAA;EAAA,CAAA,EAAA,CAAA;EAmBAN,GAAG,CAACE,MAAJ,GAAa,IAAb,CAAA;EACO,SAASK,UAAT,CAAoBH,OAApB,EAA6B;EAClCJ,EAAAA,GAAG,CAACE,MAAJ,GAAaE,OAAb,CAAA;EACD,CAAA;EAEM,SAASI,SAAT,GAAqB;EAC1BR,EAAAA,GAAG,CAACE,MAAJ,GAAa,IAAb,CAAA;EACD;;ECrBD;;MAEMO;EACJ,EAAA,SAAA,QAAA,CAAYC,IAAZ,EAAkB;EAAA,IAAA,eAAA,CAAA,IAAA,EAAA,QAAA,CAAA,CAAA;;EAChB;EACA;EACA;EACA;EACA;EACA,IAAA,IAAA,CAAKb,GAAL,GAAW,IAAIG,GAAJ,EAAX,CAAA;EACAf,IAAAA,MAAM,CAAC0B,cAAP,CAAsBD,IAAtB,EAA4B,QAA5B,EAAsC;EACpC/B,MAAAA,KAAK,EAAE,IAD6B;EAEpCiC,MAAAA,UAAU,EAAE,KAFwB;;EAAA,KAAtC,CAAA,CAAA;;EAIA,IAAA,IAAI9B,KAAK,CAAC+B,OAAN,CAAcH,IAAd,CAAJ,EAAyB;EAAE;EACzB;EACAA,MAAAA,IAAI,CAACI,SAAL,GAAiB9B,YAAjB,CAFuB;;EAGvB,MAAA,IAAA,CAAKY,aAAL,CAAmBc,IAAnB,CAAA,CAHuB;EAIxB,KAJD,MAIO;EAAE;EACP,MAAA,IAAA,CAAKK,IAAL,CAAUL,IAAV,CAAA,CADK;EAEN,KAAA;EACF,GAAA;;;;EACD,IAAA,KAAA,EAAA,SAAA,aAAA,CAAcA,IAAd,EAAoB;EAClB,MAAA,KAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGN,IAAI,CAACO,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;EAAE;EACtCE,QAAAA,OAAO,CAACR,IAAI,CAACM,CAAD,CAAL,CAAP,CAAA;EACD,OAAA;EACF,KAAA;;;EAED,IAAA,KAAA,EAAA,SAAA,IAAA,CAAKN,IAAL,EAAW;EACTzB,MAAAA,MAAM,CAACkC,IAAP,CAAYT,IAAZ,EAAkBtB,OAAlB,CAA0B,UAAAgC,GAAG,EAAI;EAAE;EACjCC,QAAAA,cAAc,CAACX,IAAD,EAAOU,GAAP,EAAYV,IAAI,CAACU,GAAD,CAAhB,CAAd,CAAA;EACD,OAFD,CAAA,CAAA;EAGD,KAAA;;;;;;EAKH,SAASE,YAAT,CAAsB3C,KAAtB,EAA6B;EAC3B,EAAA,IAAGG,KAAK,CAAC+B,OAAN,CAAclC,KAAd,CAAH,EAAwB;EAAE;EACxBA,IAAAA,KAAK,CAACS,OAAN,CAAc,UAAAmC,YAAY,EAAI;EAC5B,MAAA,IAAI9B,EAAE,GAAGyB,OAAO,CAACK,YAAD,CAAhB,CAD4B;;EAE5B,MAAA,IAAG9B,EAAH,EAAM;EACJA,QAAAA,EAAE,CAACI,GAAH,CAAOM,MAAP,EAAA,CAAA;EACD,OAAA;;EACDmB,MAAAA,YAAY,CAACC,YAAD,CAAZ,CAL4B;EAM7B,KAND,CAAA,CAAA;EAOD,GAAA;EACF,CAAA;;EAED,SAASF,cAAT,CAAwBX,IAAxB,EAA8BU,GAA9B,EAAmCzC,KAAnC,EAA0C;EAAE;EAC1C,EAAA,IAAIkB,GAAG,GAAG,IAAIG,GAAJ,EAAV,CADwC;;EAExC,EAAA,IAAIwB,OAAO,GAAGN,OAAO,CAACvC,KAAD,CAArB,CAFwC;;EAGxCM,EAAAA,MAAM,CAAC0B,cAAP,CAAsBD,IAAtB,EAA4BU,GAA5B,EAAiC;EAC/BK,IAAAA,GAD+B,EACzB,SAAA,GAAA,GAAA;EAAE;EACN,MAAGzB,IAAAA,GAAG,CAACE,MAAP,EAAe;EAAE;EACfL,QAAAA,GAAG,CAACM,MAAJ,EAAA,CADa;;EAEb,QAAA,IAAGqB,OAAH,EAAY;EAAE;EACZA,UAAAA,OAAO,CAAC3B,GAAR,CAAYM,MAAZ,EAAA,CAAA;EACAmB,UAAAA,YAAY,CAAC3C,KAAD,CAAZ,CAFU;EAGX,SAAA;EACF,OAAA;;EACD,MAAA,OAAOA,KAAP,CAAA;EACD,KAV8B;EAW/B+C,IAAAA,GAX+B,EAW3BC,SAAAA,GAAAA,CAAAA,QAX2B,EAWjB;EACZ;EACA,MAAGA,IAAAA,QAAQ,IAAKhD,KAAhB,EAAuB;EACrBuC,QAAAA,OAAO,CAACS,QAAD,CAAP,CAAA;EACAhD,QAAAA,KAAK,GAAGgD,QAAR,CAAA;EACA9B,QAAAA,GAAG,CAACC,MAAJ,EAAA,CAHqB;EAItB,OAAA;EACF,KAAA;EAlB8B,GAAjC,CAAA,CAAA;EAoBD,CAAA;;EAGM,SAASoB,OAAT,CAAiBR,IAAjB,EAAuB;EAAE;EAC9B;EACA,EAAA,IAAI,CAAC9B,QAAQ,CAAC8B,IAAD,CAAb,EAAqB;EACnB,IAAA,OAAA;EACD,GAAA;;EAED,EAAIA,IAAAA,IAAI,CAAChB,MAAT,EAAiB;EACf,IAAOgB,OAAAA,IAAI,CAAChB,MAAZ,CAAA;EACD,GAR2B;;;EAW5B,EAAA,OAAO,IAAIe,QAAJ,CAAaC,IAAb,CAAP,CAX4B;EAY7B,CAAA;EAGD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EC1GA,IAAIkB,SAAS,GAAG,EAAhB,CAAA;EACA,IAAIC,OAAO,GAAG,KAAd,CAAA;;EAEA,SAASC,cAAT,GAA0B;EACxBF,EAAAA,SAAS,CAACxC,OAAV,CAAkB,UAAA2C,EAAE,EAAA;EAAA,IAAA,OAAIA,EAAE,EAAN,CAAA;EAAA,GAApB,CAAA,CAAA;EACAF,EAAAA,OAAO,GAAG,KAAV,CAAA;EACAD,EAAAA,SAAS,GAAG,EAAZ,CAAA;EACD,CAAA;;EAED,SAASI,OAAT,GAAmB;EACjB,EAAIC,IAAAA,KAAK,GAAG,IAAZ,CAAA;;EACA,EAAA,IAAGC,OAAH,EAAY;EAAE;EACZD,IAAAA,KAAK,GAAG,SAAM,KAAA,GAAA;EACZC,MAAAA,OAAO,CAACC,OAAR,EAAkBC,CAAAA,IAAlB,CAAuB,YAAM;EAC3BN,QAAAA,cAAc,EAAA,CAAA;EACf,OAFD,CAAA,CAAA;EAGD,KAJD,CAAA;EAKD,GAND,MAMM,IAAGO,gBAAH,EAAqB;EACzB,IAAA,IAAIC,QAAQ,GAAGC,QAAQ,CAACC,cAAT,CAAwB,CAAxB,CAAf,CAAA;EACA,IAAA,IAAItB,OAAO,GAAG,IAAImB,gBAAJ,CAAqBP,cAArB,CAAd,CAAA;EACAZ,IAAAA,OAAO,CAACA,OAAR,CAAgBoB,QAAhB,EAAyB;EACvBG,MAAAA,aAAa,EAAE,IAAA;EADQ,KAAzB,CAAA,CAAA;;EAGAR,IAAAA,KAAK,GAAG,SAAM,KAAA,GAAA;EACZK,MAAAA,QAAQ,CAACI,WAAT,GAAuB,CAAvB,CAAA;EACD,KAFD,CAAA;EAGD,GATK,MASA;EACJT,IAAAA,KAAK,GAAGU,UAAU,CAACb,cAAD,CAAlB,CAAA;EACD,GAAA;;EACDG,EAAAA,KAAK,EAAA,CAAA;EACN,CAAA;;EAEM,SAASW,QAAT,CAAkBb,EAAlB,EAAsB;EAAE;EAC7BH,EAAAA,SAAS,CAACvB,IAAV,CAAe0B,EAAf,EAD2B;;EAE3B,EAAG,IAAA,CAACF,OAAJ,EAAY;EAAE;EACZG,IAAAA,OAAO,EAAA,CAAA;EACPH,IAAAA,OAAO,GAAG,IAAV,CAAA;EACD,GAAA;EACF;;ECtCD,IAAIgB,KAAK,GAAG,EAAZ,CAAA;EACA,IAAIC,GAAG,GAAG,EAAV,CAAA;EACA,IAAIC,OAAO,GAAG,KAAd,CAAA;;EAGA,SAASC,mBAAT,GAA+B;EAC7BH,EAAAA,KAAK,CAACzD,OAAN,CAAc,UAAAgB,OAAO,EAAI;EAAE;EACzBA,IAAAA,OAAO,CAAC6C,GAAR,EAAA,CAAA;EACAJ,IAAAA,KAAK,GAAG,EAAR,CAFuB;;EAGvBC,IAAAA,GAAG,GAAG,EAAN,CAAA;EACAC,IAAAA,OAAO,GAAG,KAAV,CAAA;EACD,GALD,CAAA,CAAA;EAMD,CAAA;;EAEM,SAASG,YAAT,CAAsB9C,OAAtB,EAA+B;EACpC,EAAA,IAAIL,EAAE,GAAGK,OAAO,CAACL,EAAjB,CADoC;;EAEpC,EAAA,IAAI+C,GAAG,CAAC/C,EAAD,CAAH,IAAW,IAAf,EAAqB;EAAE;EACrB8C,IAAAA,KAAK,CAACxC,IAAN,CAAWD,OAAX,EADmB;;EAEnB0C,IAAAA,GAAG,CAAC/C,EAAD,CAAH,GAAU,IAAV,CAFmB;;EAGnB,IAAI,IAAA,CAACgD,OAAL,EAAc;EAAE;EACd;EACAH,MAAAA,QAAQ,CAACI,mBAAD,CAAR,CAFY;;EAGZD,MAAAA,OAAO,GAAG,IAAV,CAAA;EACD,KAAA;EAEF,GAAA;EACF;;ECzBD,IAAIhD,EAAE,GAAG,CAAT,CAAA;EACA,IAAaoD,OAAb,gBAAA,YAAA;EACE;EACF;EACA;EACA;EACA;EACA;EACA;EACE,EAAA,SAAA,OAAA,CAAYC,EAAZ,EAAgBC,QAAhB,EAA0BtB,EAA1B,EAA8BuB,OAA9B,EAAuC;EAAA,IAAA,eAAA,CAAA,IAAA,EAAA,OAAA,CAAA,CAAA;;EACrC;EACA,IAAKF,IAAAA,CAAAA,EAAL,GAAUA,EAAV,CAAA;EACA,IAAA,IAAA,CAAKrB,EAAL,GAAUA,EAAV,CAHqC;;EAIrC,IAAKuB,IAAAA,CAAAA,OAAL,GAAeA,OAAf,CAAA;EACA,IAAA,IAAA,CAAKC,IAAL,GAAYD,OAAO,CAACC,IAApB,CALqC;;EAMrC,IAAA,IAAG,OAAOF,QAAP,IAAmB,QAAtB,EAAgC;EAAE;EAChC,MAAKG,IAAAA,CAAAA,MAAL,GAAc,YAAW;EAAG;EAC1B,QAAIC,IAAAA,GAAG,GAAGL,EAAV,CAAA;EACAC,QAAAA,QAAQ,CAACK,KAAT,CAAe,GAAf,EAAoBtE,OAApB,CAA4B,UAAA4B,CAAC,EAAI;EAC/ByC,UAAAA,GAAG,GAAGA,GAAG,CAACzC,CAAD,CAAT,CAAA;EACD,SAFD,CAAA,CAAA;EAGA,QAAA,OAAOyC,GAAP,CAAA;EACD,OAND,CAAA;EAOD,KARD,MAQM;EACJ,MAAA,IAAA,CAAKD,MAAL,GAAcH,QAAd,CADI;EAEL,KAAA;;EACD,IAAKtD,IAAAA,CAAAA,EAAL,GAAUA,EAAE,EAAZ,CAAA;EACA,IAAK4D,IAAAA,CAAAA,IAAL,GAAY,EAAZ,CAAA;EACA,IAAA,IAAA,CAAKC,MAAL,GAAc,IAAIC,GAAJ,EAAd,CAAA;EACA,IAAA,IAAA,CAAKlF,KAAL,GAAa,IAAA,CAAK8C,GAAL,EAAb,CApBqC;EAqBtC,GAAA;;EA7BH,EAAA,YAAA,CAAA,OAAA,EAAA,CAAA;EAAA,IAAA,GAAA,EAAA,KAAA;EAAA,IAAA,KAAA,EA+BE,SAAM,GAAA,GAAA;EAAE;EACNlB,MAAAA,UAAU,CAAC,IAAD,CAAV,CADI;;EAEJ,MAAA,IAAI5B,KAAK,GAAG,IAAA,CAAK6E,MAAL,EAAZ,CAFI;;EAGJhD,MAAAA,SAAS,EAAA,CAAA;EACT,MAAA,OAAO7B,KAAP,CAAA;EACD,KAAA;EApCH,GAAA,EAAA;EAAA,IAAA,GAAA,EAAA,QAAA;EAAA,IAwCE,KAAA,EAAA,SAAA,MAAA,CAAOkB,GAAP,EAAY;EAAE;EACZ,MAAI,IAAA,CAAC,IAAK+D,CAAAA,MAAL,CAAYd,GAAZ,CAAgBjD,GAAG,CAACE,EAApB,CAAL,EAA8B;EAAG;EAC/B,QAAK6D,IAAAA,CAAAA,MAAL,CAAYE,GAAZ,CAAgBjE,GAAG,CAACE,EAApB,EAD4B;;EAE5B,QAAA,IAAA,CAAK4D,IAAL,CAAUtD,IAAV,CAAeR,GAAf,EAF4B;;EAG5BA,QAAAA,GAAG,CAACkE,MAAJ,CAAW,IAAX,EAH4B;EAI7B,OAAA;EACF,KAAA;EA9CH,GAAA,EAAA;EAAA,IAAA,GAAA,EAAA,QAAA;EAAA,IAAA,KAAA,EAgDE,SAAS,MAAA,GAAA;EAAE;EACT;EACA;EACA;EACAb,MAAAA,YAAY,CAAC,IAAD,CAAZ,CAAA;EACD,KAAA;EArDH,GAAA,EAAA;EAAA,IAAA,GAAA,EAAA,KAAA;EAAA,IAAA,KAAA,EAuDE,SAAM,GAAA,GAAA;EACJ,MAAA,IAAIc,QAAQ,GAAG,IAAKrF,CAAAA,KAApB,CADI;;EAEJ,MAAIgD,IAAAA,QAAQ,GAAG,IAAKhD,CAAAA,KAAL,GAAa,IAAK8C,CAAAA,GAAL,EAA5B,CAFI;;EAGJ,MAAG,IAAA,IAAA,CAAK8B,IAAR,EAAc;EACZ,QAAKxB,IAAAA,CAAAA,EAAL,CAAQxC,IAAR,CAAa,IAAA,CAAK6D,EAAlB,EAAqBzB,QAArB,EAA8BqC,QAA9B,CAAA,CADY;EAEb,OAAA;EACF,KAAA;EA7DH,GAAA,CAAA,CAAA,CAAA;;EAAA,EAAA,OAAA,OAAA,CAAA;EAAA,CAAA,EAAA;EAmEA;EACA;EACA;EACE;EACA;EACF;;ECxEO,SAASC,SAAT,CAAmBb,EAAnB,EAAuB;EAC5B,EAAA,IAAMc,IAAI,GAAGd,EAAE,CAACe,QAAhB,CAAA;;EACA,EAAGD,IAAAA,IAAI,CAACxD,IAAR,EAAc;EAAE;EACd0D,IAAAA,QAAQ,CAAChB,EAAD,CAAR,CADY;EAEb,GAJ2B;EAM5B;EACA;;;EACA,EAAGc,IAAAA,IAAI,CAACG,KAAR,EAAc;EACZC,IAAAA,SAAS,CAAClB,EAAD,EAAIc,IAAI,CAACG,KAAT,CAAT,CAAA;EACD,GAAA;EACF,CAAA;;EAED,SAASD,QAAT,CAAkBhB,EAAlB,EAAsB;EAAE;EACtB,EAAI1C,IAAAA,IAAI,GAAG0C,EAAE,CAACe,QAAH,CAAYzD,IAAvB,CADoB;EAEpB;EAEA;;EACAA,EAAAA,IAAI,GAAG0C,EAAE,CAACmB,KAAH,GAAW7F,UAAU,CAACgC,IAAD,CAAV,GAAmBA,IAAI,CAACnB,IAAL,CAAU6D,EAAV,CAAnB,GAAmC1C,IAArD,CAAA;;EACA,EAAA,KAAK,IAAMU,GAAX,IAAkBV,IAAlB,EAAwB;EAAE;EACxB8D,IAAAA,KAAK,CAACpB,EAAD,EAAI,OAAJ,EAAYhC,GAAZ,CAAL,CAAA;EACD,GARmB;;;EAUpBF,EAAAA,OAAO,CAACR,IAAD,CAAP,CAAA;EACD,CAAA;;EAED,SAAS4D,SAAT,CAAmBlB,EAAnB,EAAsBiB,KAAtB,EAA6B;EAAA,EAAA,IAAA,KAAA,GAAA,SAAA,KAAA,CAChBjD,GADgB,EAAA;EACA;EACzB,IAAA,IAAIqD,OAAO,GAAGJ,KAAK,CAACjD,GAAD,CAAnB,CAAA;;EACA,IAAA,IAAGtC,KAAK,CAAC+B,OAAN,CAAc4D,OAAd,CAAH,EAA2B;EAAE;EAC3BA,MAAAA,OAAO,CAACrF,OAAR,CAAgB,UAAAsF,SAAS,EAAI;EAC3BC,QAAAA,WAAW,CAACvB,EAAD,EAAIhC,GAAJ,EAAQsD,SAAR,CAAX,CAAA;EACD,OAFD,CAAA,CAAA;EAGD,KAJD,MAIM;EACJ,MAAA,IAAG,OAAOD,CAAAA,OAAP,CAAmB,KAAA,QAAtB,EAAgC;EAAE;EAChCE,QAAAA,WAAW,CAACvB,EAAD,EAAIhC,GAAJ,EAAQqD,OAAO,CAACA,OAAhB,EAAwBA,OAAxB,CAAX,CAAA;EACD,OAFD,MAEM;EACJE,QAAAA,WAAW,CAACvB,EAAD,EAAIhC,GAAJ,EAAQqD,OAAR,CAAX,CADI;EAEL,OAAA;EACF,KAAA;EAbwB,GAAA,CAAA;;EAAE;EAC7B,EAAA,KAAK,IAAMrD,GAAX,IAAkBiD,KAAlB,EAAyB;EAAA,IAAA,KAAA,CAAdjD,GAAc,CAAA,CAAA;EAaxB,GAAA;EACF,CAAA;;EAED,SAASuD,WAAT,CAAqBvB,EAArB,EAAwBhC,GAAxB,EAA4BqD,OAA5B,EAAkD;EAAA,EAAdnB,IAAAA,OAAc,uEAAJ,EAAI,CAAA;EAChD,EAAOF,OAAAA,EAAE,CAACwB,MAAH,CAAUxD,GAAV,EAAcqD,OAAd,EAAsBnB,OAAtB,CAAP,CADgD;EAEjD;;;EAID,SAASkB,KAAT,CAAepB,EAAf,EAAkByB,MAAlB,EAAyBzD,GAAzB,EAA8B;EAC5BnC,EAAAA,MAAM,CAAC0B,cAAP,CAAsByC,EAAtB,EAAyBhC,GAAzB,EAA6B;EAC3BK,IAAAA,GAD2B,EACrB,SAAA,GAAA,GAAA;EACJ,MAAA,OAAO2B,EAAE,CAACyB,MAAD,CAAF,CAAWzD,GAAX,CAAP,CAAA;EACD,KAH0B;EAI3BM,IAAAA,GAJ2B,EAIvBC,SAAAA,GAAAA,CAAAA,QAJuB,EAIb;EACZyB,MAAAA,EAAE,CAACyB,MAAD,CAAF,CAAWzD,GAAX,IAAkBO,QAAlB,CAAA;EACD,KAAA;EAN0B,GAA7B,CAAA,CAAA;EAQD,CAAA;;EAEM,SAASmD,UAAT,CAAoBC,GAApB,EAAyB;EAC9BA,EAAAA,GAAG,CAAChG,SAAJ,CAAc6F,MAAd,GAAuB,UAAUxD,GAAV,EAAcqD,OAAd,EAAsBnB,OAAtB,EAA+B;EAAE;EACtDA,IAAAA,OAAO,CAACC,IAAR,GAAe,IAAf,CADoD;;EAEpD,IAAA,IAAIyB,WAAW,GAAG,IAAI7B,OAAJ,CAAY,IAAZ,EAAiB/B,GAAjB,EAAqBqD,OAArB,EAA6BnB,OAA7B,CAAlB,CAFoD;;EAGpD,IAAGA,IAAAA,OAAO,CAAC2B,SAAX,EAAsB;EACpBR,MAAAA,OAAO,CAACO,WAAW,CAACrG,KAAb,CAAP,CAAA;EACD,KAAA;EACF,GAND,CAAA;EAOD;;ECtED,IAAMuG,MAAM,GAAZ,8BAAA;;EACA,IAAMC,YAAY,GAAUD,MAAAA,CAAAA,MAAAA,CAAAA,MAAV,kBAAwBA,MAAxB,EAAA,GAAA,CAAlB;EACA;;EACA,IAAME,YAAY,GAAG,IAAIC,MAAJ,aAAgBF,YAAhB,CAAA,CAArB;EACA;;EACA,IAAMG,MAAM,GAAG,IAAID,MAAJ,gBAAmBF,YAAnB,EAAA,QAAA,CAAA,CAAf;;EACA,IAAMI,SAAS,GAAG,2EAAlB;;EACA,IAAMC,aAAa,GAAG,YAAtB;;EAGA,IAAIC,IAAI,GAAG,IAAX,CAAA;EACA,IAAIC,UAAJ,CAAA;EACA,IAAIC,KAAK,GAAG,EAAZ,CAAA;EACA,IAAMC,YAAY,GAAG,CAArB;;EACA,IAAMC,SAAS,GAAG,CAAlB;EAEA;;EACO,SAASC,UAAT,CAAoBC,IAApB,EAA0B;EAAE;EACjC,EAAA,OAAOA,IAAP,EAAa;EAAE;EACb,IAAIC,IAAAA,OAAO,GAAGD,IAAI,CAACE,OAAL,CAAa,GAAb,CAAd,CADW;;EAEX,IAAID,IAAAA,OAAO,IAAI,CAAf,EAAkB;EAChB,MAAA,IAAME,aAAa,GAAGC,aAAa,EAAnC,CADgB;;EAEhB,MAAA,IAAID,aAAJ,EAAmB;EACjBE,QAAAA,KAAK,CAACF,aAAa,CAACG,OAAf,EAAwBH,aAAa,CAACI,KAAtC,CAAL,CAAA;EACA,QAAA,SAAA;EACD,OAAA;;EAED,MAAA,IAAMC,WAAW,GAAGC,WAAW,CAAA,CAA/B,CAAA;;EACA,MAAA,IAAID,WAAJ,EAAiB;EACfE,QAAAA,GAAG,CAACF,WAAW,CAAC,CAAD,CAAZ,CAAH,CAAA;EACA,QAAA,SAAA;EACD,OAAA;EAEF,KAAA;;EACD,IAAA,IAAIG,IAAI,GAAR,KAAA,CAAA,CAAA;;EACA,IAAIV,IAAAA,OAAO,GAAG,CAAd,EAAiB;EACfU,MAAAA,IAAI,GAAGX,IAAI,CAACY,SAAL,CAAe,CAAf,EAAkBX,OAAlB,CAAP,CAAA;EACD,KAAA;;EACD,IAAA,IAAIU,IAAJ,EAAU;EACRE,MAAAA,KAAK,CAACF,IAAD,CAAL,CAAA;EACAG,MAAAA,OAAO,CAACH,IAAI,CAACzF,MAAN,CAAP,CAAA;EACD,KAAA;EAEF,GAAA;;EAED,EAAA,SAASkF,aAAT,GAAyB;EACvB,IAAIC,IAAAA,KAAK,GAAGL,IAAI,CAACe,KAAL,CAAW1B,YAAX,CAAZ,CADuB;;EAEvB,IAAA,IAAIgB,KAAJ,EAAW;EAAE;EACX,MAAA,IAAMU,KAAK,GAAG;EACZT,QAAAA,OAAO,EAAED,KAAK,CAAC,CAAD,CADF;EAEZE,QAAAA,KAAK,EAAE,EAAA;EAFK,OAAd,CAAA;EAIAO,MAAAA,OAAO,CAACT,KAAK,CAAC,CAAD,CAAL,CAASnF,MAAV,CAAP,CALS;;EAMT,MAAA,IAAIwF,IAAJ,EAASM,IAAT,CANS;;;EAQT,MAAA,OAAO,EAAEN,IAAG,GAAGV,IAAI,CAACe,KAAL,CAAWtB,aAAX,CAAR,MAAuCuB,IAAI,GAAGhB,IAAI,CAACe,KAAL,CAAWvB,SAAX,CAA9C,CAAP,EAA6E;EAC3EuB,QAAAA,KAAK,CAACR,KAAN,CAAYjG,IAAZ,CAAiB;EAAE2G,UAAAA,IAAI,EAAED,IAAI,CAAC,CAAD,CAAZ;EAAiBpI,UAAAA,KAAK,EAAEoI,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAf,IAAsBA,IAAI,CAAC,CAAD,CAAA;EAAlD,SAAjB,CAAA,CAAA;EACAF,QAAAA,OAAO,CAACE,IAAI,CAAC,CAAD,CAAJ,CAAQ9F,MAAT,CAAP,CAF2E;EAG5E,OAAA;;EACD,MAAA,IAAIwF,IAAJ,EAAS;EAAE;EACTI,QAAAA,OAAO,CAACJ,IAAG,CAAC,CAAD,CAAH,CAAOxF,MAAR,CAAP,CAAA;EACA,QAAA,OAAO6F,KAAP,CAAA;EACD,OAAA;EACF,KAAA;EACF,GAAA;;EAED,EAAA,SAASN,WAAT,GAAuB;EACrB,IAAID,IAAAA,WAAW,GAAGR,IAAI,CAACe,KAAL,CAAWxB,MAAX,CAAlB,CADqB;;EAErBuB,IAAAA,OAAO,CAACN,WAAW,CAAC,CAAD,CAAX,CAAetF,MAAhB,CAAP,CAAA;EACA,IAAA,OAAOsF,WAAP,CAAA;EACD,GAAA;;EAED,EAASM,SAAAA,OAAT,CAAiBI,GAAjB,EAAsB;EACpBlB,IAAAA,IAAI,GAAGA,IAAI,CAACY,SAAL,CAAeM,GAAf,CAAP,CAAA;EACD,GAAA;;EAED,EAAA,OAAOxB,IAAP,CAAA;EACD,CAAA;;EAGD,SAASyB,aAAT,CAAuBb,OAAvB,EAAgCC,KAAhC,EAAuC;EACrC,EAAO,OAAA;EACLa,IAAAA,IAAI,EAAEvB,YADD;EAELwB,IAAAA,GAAG,EAAEf,OAFA;EAGLgB,IAAAA,QAAQ,EAAE,EAHL;EAILf,IAAAA,KAAK,EAALA,KAJK;EAKLgB,IAAAA,MAAM,EAAE,IAAA;EALH,GAAP,CAAA;EAOD,CAAA;;EAED,SAASlB,KAAT,CAAeC,OAAf,EAAwBkB,QAAxB,EAAkC;EAChC,EAAA,IAAIC,OAAO,GAAGN,aAAa,CAACb,OAAD,EAAUkB,QAAV,CAA3B,CAAA;;EACA,EAAI,IAAA,CAAC9B,IAAL,EAAW;EACTA,IAAAA,IAAI,GAAG+B,OAAP,CAAA;EACD,GAAA;;EACD7B,EAAAA,KAAK,CAACtF,IAAN,CAAWmH,OAAX,CAAA,CAAA;EACA9B,EAAAA,UAAU,GAAG8B,OAAb,CAAA;EACD,CAAA;;EACD,SAASf,GAAT,CAAaJ,OAAb,EAAsB;EACpB,EAAA,IAAIoB,cAAc,GAAG9B,KAAK,CAAC+B,GAAN,EAArB,CAAA;EACA,EAAIC,IAAAA,aAAa,GAAGhC,KAAK,CAACA,KAAK,CAAC1E,MAAN,GAAe,CAAhB,CAAzB,CAAA;;EACA,EAAA,IAAIoF,OAAO,IAAIoB,cAAc,CAACL,GAA9B,EAAmC;EACjC,IAAA,IAAIO,aAAJ,EAAmB;EACjBA,MAAAA,aAAa,CAACN,QAAd,CAAuBhH,IAAvB,CAA4BoH,cAA5B,CAAA,CAAA;EACAA,MAAAA,cAAc,CAACH,MAAf,GAAwBK,aAAxB,CAAA;EACD,KAAA;EACF,GAAA;EACF,CAAA;;EACD,SAASf,KAAT,CAAeF,IAAf,EAAqB;EACnBA,EAAAA,IAAI,GAAGA,IAAI,CAACkB,OAAL,CAAa,KAAb,EAAoB,EAApB,CAAP,CAAA;;EACA,EAAA,IAAIlB,IAAJ,EAAU;EACRhB,IAAAA,UAAU,CAAC2B,QAAX,CAAoBhH,IAApB,CAAyB;EACvB8G,MAAAA,IAAI,EAAEtB,SADiB;EAEvBa,MAAAA,IAAI,EAAJA,IAAAA;EAFuB,KAAzB,CAAA,CAAA;EAID,GAAA;EACF;;ECpHD,IAAMmB,YAAY,GAAG,0BAArB;;EAEA,SAASC,SAAT,CAAmBxB,KAAnB,EAA0B;EACxB,EAAA,IAAIyB,KAAK,GAAT,EAAA,CAAA;EACAzB,EAAAA,KAAK,CAAClH,OAAN,CAAc,UAAA2H,IAAI,EAAI;EAAE;EACtB,IAAA,IAAGA,IAAI,CAACC,IAAL,KAAc,OAAjB,EAA0B;EAAE;EAC1B,MAAA,IAAIvD,GAAG,GAAG,EAAV,CADwB;;EAExBsD,MAAAA,IAAI,CAACpI,KAAL,CAAW+E,KAAX,CAAiB,GAAjB,CAAA,CAAsBtE,OAAtB,CAA8B,UAAA4I,SAAS,EAAI;EAAI;EAC7C,QAAA,IAAA,gBAAA,GAAkBA,SAAS,CAACtE,KAAV,CAAgB,GAAhB,CAAlB;EAAA,YAAA,iBAAA,GAAA,cAAA,CAAA,gBAAA,EAAA,CAAA,CAAA;EAAA,YAAKtC,GAAL,GAAA,iBAAA,CAAA,CAAA,CAAA;EAAA,YAASzC,KAAT,wBADyC;;;EAEzC8E,QAAAA,GAAG,CAACrC,GAAD,CAAH,GAAczC,EAAAA,CAAAA,MAAAA,CAAAA,KAAd,EAFyC;EAG1C,OAHD,CAAA,CAAA;EAIAoI,MAAAA,IAAI,CAACpI,KAAL,GAAa8E,GAAb,CANwB;EAOzB,KAAA;;EACDsE,IAAAA,KAAK,IAAOhB,EAAAA,CAAAA,MAAAA,CAAAA,IAAI,CAACC,IAAZ,cAAoBiB,IAAI,CAACC,SAAL,CAAenB,IAAI,CAACpI,KAApB,CAApB,EAAA,GAAA,CAAL,CAToB;EAUrB,GAVD,CAAA,CAAA;EAWA,EAAWoJ,OAAAA,GAAAA,CAAAA,MAAAA,CAAAA,KAAK,CAACpI,KAAN,CAAY,CAAZ,EAAc,CAAC,CAAf,CAAX,EAAA,GAAA,CAAA,CAbwB;EAczB,CAAA;;EAED,SAASwI,GAAT,CAAaC,IAAb,EAAmB;EACjB,EAAA,IAAGA,IAAI,CAACjB,IAAL,IAAa,CAAhB,EAAkB;EAAE;EAClB,IAAOkB,OAAAA,QAAQ,CAACD,IAAD,CAAf,CAAA;EACD,GAFD,MAEM;EAAE;EACN,IAAA,IAAI1B,IAAI,GAAG0B,IAAI,CAAC1B,IAAhB,CADI;;EAEJ,IAAA,IAAI4B,MAAM,GAAG,EAAb,CAFI;;EAGJ,IAAA,IAAIxB,KAAJ,CAAA;EACA,IAAIyB,IAAAA,SAAS,GAAGV,YAAY,CAACU,SAAb,GAAyB,CAAzC,CAJI;;EAKJ,IAAMzB,OAAAA,KAAK,GAAGe,YAAY,CAACW,IAAb,CAAkB9B,IAAlB,CAAd,EAAsC;EAAE;EACtC,MAAA,IAAI+B,KAAK,GAAG3B,KAAK,CAAC2B,KAAlB,CADoC;;EAEpC,MAAGA,IAAAA,KAAK,GAAGF,SAAX,EAAsB;EAAE;EACtBD,QAAAA,MAAM,CAACjI,IAAP,CAAY4H,IAAI,CAACC,SAAL,CAAexB,IAAI,CAAC/G,KAAL,CAAW4I,SAAX,EAAqBE,KAArB,CAAf,CAAZ,EADoB;EAErB,OAAA;;EACDH,MAAAA,MAAM,CAACjI,IAAP,CAAA,KAAA,CAAA,MAAA,CAAkByG,KAAK,CAAC,CAAD,CAAL,CAAS4B,IAAT,EAAlB,EAAA,GAAA,CAAA,CAAA,CALoC;;EAMpCH,MAAAA,SAAS,GAAGE,KAAK,GAAG3B,KAAK,CAAC,CAAD,CAAL,CAAS7F,MAA7B,CANoC;EAOrC,KAAA;;EACD,IAAA,IAAGsH,SAAS,GAAC7B,IAAI,CAACzF,MAAlB,EAA0B;EAAE;EAC1BqH,MAAAA,MAAM,CAACjI,IAAP,CAAY4H,IAAI,CAACC,SAAL,CAAexB,IAAI,CAAC/G,KAAL,CAAW4I,SAAX,CAAf,CAAZ,CAAA,CAAA;EACD,KAAA;;EACD,IAAA,OAAA,KAAA,CAAA,MAAA,CAAaD,MAAM,CAACK,IAAP,CAAY,GAAZ,CAAb,OAhBI;EAiBL,GAAA;EACF,CAAA;;EAED,SAASC,YAAT,CAAsBnD,IAAtB,EAA4B;EAC1B,EAAA,IAAI4B,QAAQ,GAAG5B,IAAI,CAAC4B,QAApB,CAD0B;;EAE1B,EAAA,IAAGA,QAAQ,IAAIA,QAAQ,CAACpG,MAAT,GAAkB,CAAjC,EAAoC;EAClC,IAAA,OAAOoG,QAAQ,CAACwB,GAAT,CAAa,UAAAC,CAAC,EAAA;EAAA,MAAIX,OAAAA,GAAG,CAACW,CAAD,CAAP,CAAA;EAAA,KAAd,CAA0BH,CAAAA,IAA1B,CAA+B,GAA/B,CAAP,CAAA;EACD,GAFD,MAEK;EACH,IAAA,OAAO,KAAP,CAAA;EACD,GAAA;EACF,CAAA;;EAEM,SAASN,QAAT,CAAkB5C,IAAlB,EAAwB;EAAE;EACjC,EAAA,IAAI4B,QAAQ,GAAGuB,YAAY,CAACnD,IAAD,CAA3B,CAD+B;EAE7B;;EACA,EAAA,IAAIsD,IAAI,GAAA,MAAA,CAAA,MAAA,CAAUtD,IAAI,CAAC2B,GAAf,EAAA,IAAA,CAAA,CAAA,MAAA,CAAuB3B,IAAI,CAACa,KAAL,CAAWrF,MAAX,GAAoB,CAApB,GAAwB6G,SAAS,CAACrC,IAAI,CAACa,KAAN,CAAjC,GAAgD0C,SAAvE,CAAmF3B,CAAAA,MAAAA,CAAAA,QAAQ,GAAOA,GAAAA,CAAAA,MAAAA,CAAAA,QAAP,CAAoB,GAAA,EAA/G,EAAR,GAAA,CAAA,CAAA;EACA,EAAA,OAAO0B,IAAP,CAAA;EACD;;ECrDM,SAASE,iBAAT,CAA2BC,QAA3B,EAAqC;EAC1C,EAAA,IAAIzD,IAAI,GAAGK,UAAU,CAACoD,QAAD,CAArB,CAD0C;;EAE1C,EAAA,IAAIH,IAAI,GAAGV,QAAQ,CAAC5C,IAAD,CAAnB,CAAA;EACA,EAAI0D,IAAAA,MAAM,GAAG,IAAIC,QAAJ,8BAAmCL,IAAnC,EAAA,GAAA,CAAA,CAAb,CAH0C;;EAM1C,EAAA,OAAOI,MAAP,CAAA;EACD;EAED;EACA;EACA;EACA;EAIA;EACA;EACA;EACA;;ECrBO,SAASE,KAAT,CAAeC,MAAf,EAAuBC,KAAvB,EAA8B;EACnC,EAAA,IAAMC,SAAS,GAAGF,MAAM,CAACG,QAAzB,CAAA;;EACA,EAAA,IAAID,SAAJ,EAAe;EACb,IAAA,IAAIE,EAAE,GAAIC,SAAS,CAACJ,KAAD,CAAnB,CADa;;EAEb,IAAA,IAAIK,SAAS,GAAGN,MAAM,CAACO,UAAvB,CAFa;;EAGbD,IAAAA,SAAS,CAACE,YAAV,CAAuBJ,EAAvB,EAA0BJ,MAAM,CAACS,WAAjC,CAAA,CAHa;;EAIbH,IAAAA,SAAS,CAACI,WAAV,CAAsBV,MAAtB,EAJa;;EAKb,IAAOI,OAAAA,EAAP,CALa;EAMd,GAAA;EACF,CAAA;;EAED,SAASC,SAAT,CAAmBJ,KAAnB,EAA0B;EACxB,EAAA,IAAQlD,OAAR,GAA+CkD,KAA/C,CAAQlD,OAAR,CAAA;EAAA,MAA+CkD,KAA/C,CAAiB7I,IAAjB,CAAA;EAAA,MAA+C6I,KAA/C,CAAuBnI,GAAvB,CAAA;EAAA,UAA4BiG,QAA5B,GAA+CkC,KAA/C,CAA4BlC,QAA5B,CAAA;EAAA,MAAsCX,IAAtC,GAA+C6C,KAA/C,CAAsC7C,KAAtC;;EACA,EAAA,IAAIL,OAAJ,EAAa;EAAE;EACbkD,IAAAA,KAAK,CAACG,EAAN,GAAWnH,QAAQ,CAAC2E,aAAT,CAAuBb,OAAvB,CAAX,CADW;;EAEX4D,IAAAA,WAAW,CAACV,KAAD,CAAX,CAFW;;EAGX,IAAA,IAAIlC,QAAQ,IAAIA,QAAQ,CAACpG,MAAT,GAAkB,CAAlC,EAAqC;EAAE;EACrCoG,MAAAA,QAAQ,CAACjI,OAAT,CAAiB,UAAA8K,KAAK,EAAI;EAAE;EAC3B,QAAA,OAAOX,KAAK,CAACG,EAAN,CAASS,WAAT,CAAqBR,SAAS,CAACO,KAAD,CAA9B,CAAP,CADyB;EAEzB,OAFD,CAAA,CAAA;EAGD,KAAA;EACF,GARD,MAQO;EAAE;EACP,IAAA,OAAO3H,QAAQ,CAACC,cAAT,CAAwBkE,IAAxB,CAAP,CADK;EAEN,GAAA;;EACD,EAAA,OAAO6C,KAAK,CAACG,EAAb,CAbwB;EAczB,CAAA;;EAED,SAASO,WAAT,CAAqBV,KAArB,EAA4B;EAAE;EAC5B,EAAA,IAAMG,EAAE,GAAGH,KAAK,CAACG,EAAjB,CAD0B;;EAE1B,EAAA,IAAMpD,KAAK,GAAGiD,KAAK,CAAC7I,IAApB,CAF0B;;EAG1B,EAAA,KAAK,IAAMU,GAAX,IAAkBkF,KAAlB,EAAyB;EAAE;EACzB,IAAIrH,IAAAA,MAAM,CAACmL,cAAP,CAAsB7K,IAAtB,CAA2B+G,KAA3B,EAAkClF,GAAlC,CAAJ,EAA4C;EAC1C,MAAIA,IAAAA,GAAG,KAAK,OAAZ,EAAqB;EAAE;EACrB;EACA;EACA;EACA;EACA;EACA;EACA;EACA,QAAA,KAAK,IAAMA,IAAX,IAAkBkF,KAAK,CAAC+D,KAAxB,EAA+B;EAAE;EAC/BX,UAAAA,EAAE,CAACW,KAAH,CAASjJ,IAAT,CAAA,GAAgBkF,KAAK,CAAC+D,KAAN,CAAYjJ,IAAZ,CAAhB,CAD6B;EAE9B,SAAA;EACF,OAXD,MAWO,IAAIA,GAAG,KAAK,OAAZ,EAAqB;EAAE;EAC5BsI,QAAAA,EAAE,CAACY,SAAH,GAAehE,KAAK,CAApB,OAAA,CAAA,CAAA;EACD,OAFM,MAEA;EACLoD,QAAAA,EAAE,CAACa,YAAH,CAAgBnJ,GAAhB,EAAqBkF,KAAK,CAAClF,GAAD,CAA1B,CAAA,CADK;EAEN,OAAA;EACF,KAAA;EACF,GAAA;EACF;EAID;EACA;;ECpDO,SAASoJ,cAAT,CAAwBzF,GAAxB,EAA6B;EAClCA,EAAAA,GAAG,CAAChG,SAAJ,CAAc0L,OAAd,GAAwB,UAAUlB,KAAV,EAAiB;EAAE;EACzC,IAAInG,IAAAA,EAAE,GAAG,IAAT,CAAA;EACAA,IAAAA,EAAE,CAACsH,GAAH,GAASrB,KAAK,CAACjG,EAAE,CAACsH,GAAJ,EAASnB,KAAT,CAAd,CAFuC;EAGvC;EAED,GALD,EAOExE,GAAG,CAAChG,SAAJ,CAAc4L,SAAd,GAA0B/H,QAP5B,CAAA;EAQD;;EAGM,SAASgI,cAAT,CAAwBxH,EAAxB,EAA4BsG,EAA5B,EAAgC;EACrC,EAAgBtG,EAAE,CAACe,SAAnB;EACAf,EAAAA,EAAE,CAACsH,GAAH,GAAShB,EAAT,CAAA;;EACA,EAAA,IAAImB,eAAe,GAAG,SAAlBA,eAAkB,GAAM;EAC1BzH,IAAAA,EAAE,CAACqH,OAAH,CAAWrH,EAAE,CAAC0H,OAAH,EAAX,CAAA,CAAA;EACD,GAFD,CAHqC;;;EAQrC,EAAA,IAAI3H,OAAJ,CAAYC,EAAZ,EAAgByH,eAAhB,EAAiC,YAAM;EACrCE,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,CAAA,CAAA;EACD,GAFD,EAEG,IAFH,CAAA,CAAA;EAID;EAGD;EACA;EACA;EACE;EACA;EACA;EACA;;ECjCK,SAASC,SAAT,CAAmBlG,GAAnB,EAAwB;EAC7BA,EAAAA,GAAG,CAAChG,SAAJ,CAAcmM,KAAd,GAAsB,UAAS5H,OAAT,EAAkB;EACtC,IAAA,IAAMF,EAAE,GAAG,IAAX,CADsC;;EAEtCA,IAAAA,EAAE,CAACe,QAAH,GAAcb,OAAd,CAFsC;EAItC;;EACAW,IAAAA,SAAS,CAACb,EAAD,CAAT,CAAA;;EAEA,IAAA,IAAGA,EAAE,CAACe,QAAH,CAAYuF,EAAf,EAAkB;EAChBtG,MAAAA,EAAE,CAAC+H,MAAH,CAAU/H,EAAE,CAACe,QAAH,CAAYuF,EAAtB,CAAA,CADgB;EAEjB,KAAA;EACF,GAVD,CAAA;;EAWA3E,EAAAA,GAAG,CAAChG,SAAJ,CAAcoM,MAAd,GAAuB,UAASzB,EAAT,EAAa;EAClC,IAAMtG,IAAAA,EAAE,GAAG,IAAX,CAAA;EACA,IAAA,IAAIE,OAAO,GAAGF,EAAE,CAACe,QAAjB,CAAA;EACAuF,IAAAA,EAAE,GAAGnH,QAAQ,CAAC6I,aAAT,CAAuB1B,EAAvB,CAAL,CAAA;;EACA,IAAA,IAAG,CAACpG,OAAO,CAAC6F,MAAZ,EAAoB;EAAE;EACpB,MAAA,IAAID,QAAQ,GAAG5F,OAAO,CAAC4F,QAAvB,CAAA;;EACA,MAAA,IAAG,CAACA,QAAD,IAAaQ,EAAhB,EAAoB;EAAE;EACpBR,QAAAA,QAAQ,GAAGQ,EAAE,CAAC2B,SAAd,CADkB;;EAElB,QAAA,IAAIlC,MAAM,GAAGF,iBAAiB,CAACC,QAAD,CAA9B,CAFkB;;EAGlB5F,QAAAA,OAAO,CAAC6F,MAAR,GAAiBA,MAAjB,CAHkB;EAInB,OAAA;EACF,KAAA;;EACDyB,IAAAA,cAAc,CAACxH,EAAD,EAAIsG,EAAJ,CAAd,CAZkC;EAanC,GAbD,CAAA;EAeD;;EC/BM,SAAS4B,iBAAT,CAA2BjF,OAA3B,EAA0D;EAAA,EAAvB3F,IAAAA,IAAuB,uEAAhB,EAAgB,CAAA;EAAE;EACjE,EAAA,IAAIU,GAAG,GAAGV,IAAI,CAACU,GAAf,CAAA;;EACA,EAAA,IAAGA,GAAH,EAAQ;EACN,IAAOV,OAAAA,IAAI,CAACU,GAAZ,CAAA;EACD,GAAA;;EAJ8D,EAAA,KAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAAViG,QAAU,GAAA,IAAA,KAAA,CAAA,IAAA,GAAA,CAAA,GAAA,IAAA,GAAA,CAAA,GAAA,CAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,IAAA,GAAA,IAAA,EAAA,IAAA,EAAA,EAAA;EAAVA,IAAAA,QAAU,CAAA,IAAA,GAAA,CAAA,CAAA,GAAA,SAAA,CAAA,IAAA,CAAA,CAAA;EAAA,GAAA;;EAK/D,EAAOkC,OAAAA,KAAK,CAAClD,OAAD,EAAS3F,IAAT,EAAcU,GAAd,EAAkBiG,QAAlB,EAA2B2B,SAA3B,CAAZ,CAAA;EACD,CAAA;EAEM,SAASxG,cAAT,CAAwBkE,IAAxB,EAA8B;EAAE;EACrC,EAAO6C,OAAAA,KAAK,CAACP,SAAD,EAAWA,SAAX,EAAqBA,SAArB,EAA+BA,SAA/B,EAAyCtC,IAAzC,CAAZ,CAAA;EACD,CAAA;;EAED,SAAS6C,KAAT,CAAelD,OAAf,EAAwB3F,IAAxB,EAA8BU,GAA9B,EAAmCiG,QAAnC,EAA6CX,IAA7C,EAAmD;EAAE;EACnD,EAAO,OAAA;EACLL,IAAAA,OAAO,EAAPA,OADK;EACI3F,IAAAA,IAAI,EAAJA,IADJ;EACUU,IAAAA,GAAG,EAAHA,GADV;EACeiG,IAAAA,QAAQ,EAARA,QADf;EACyBX,IAAAA,IAAI,EAAJA,IAAAA;EADzB,GAAP,CAAA;EAGD;;ECZM,SAAS6E,WAAT,CAAqBxG,GAArB,EAA0B;EAC/BA,EAAAA,GAAG,CAAChG,SAAJ,CAAcyM,EAAd,GAAmB,YAAY;EAAE;EAC/B,IAAA,OAAOF,iBAAiB,CAAA,KAAjB,CAAqBG,KAAAA,CAAAA,EAAAA,SAArB,CAAP,CAAA;EACD,GAFD,CAAA;;EAIA1G,EAAAA,GAAG,CAAChG,SAAJ,CAAc2M,EAAd,GAAmB,UAAUhF,IAAV,EAAgB;EAAG;EACpC,IAAOlE,OAAAA,cAAc,CAACkE,IAAD,CAArB,CAAA;EACD,GAFD,CAAA;;EAIA3B,EAAAA,GAAG,CAAChG,SAAJ,CAAc4M,EAAd,GAAmB,UAAUC,GAAV,EAAe;EAAE;EAClC,IAAOA,OAAAA,GAAG,KAAK,IAAR,GAAe,EAAf,GAAqB,OAAA,CAAOA,GAAP,CAAe,KAAA,QAAf,GAA0B3D,IAAI,CAACC,SAAL,CAAe0D,GAAf,CAA1B,GAAgDA,GAA5E,CADgC;EAEjC,GAFD,CAAA;;EAIA7G,EAAAA,GAAG,CAAChG,SAAJ,CAAc+L,OAAd,GAAwB,YAAY;EAClC,IAAA,IAAI3B,MAAM,GAAG,IAAA,CAAKhF,QAAL,CAAcgF,MAA3B,CADkC;;EAElC,IAAA,OAAOA,MAAM,CAAC5J,IAAP,CAAY,IAAZ,CAAP,CAFkC;EAGnC,GAHD,CAAA;EAID;;ECjBD,SAASwF,GAAT,CAAczB,OAAd,EAAuB;EACrB;EACA,EAAA,IAAA,CAAK4H,KAAL,CAAW5H,OAAX,CAAA,CAFqB;;EAGtB,CAAA;;EAED2H,SAAS,CAAClG,GAAD,CAAT;;EACAwG,WAAW,CAACxG,GAAD,CAAX;;EACAD,UAAU,CAACC,GAAD,CAAV,CAAA;EACAyF,cAAc,CAACzF,GAAD,CAAd;;;;;;;;"}